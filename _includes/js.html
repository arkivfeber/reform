<script type="text/javascript" src="{{ '/assets/js/libs/jquery.min.js' | prepend: site.baseurl }}"></script>
<script type="text/javascript" src="{{ '/assets/js/libs/jquery.scrollstop.js' | prepend: site.baseurl }}"></script>
<script type="text/javascript" src="{{ '/assets/js/libs/rrssb.min.js' | prepend: site.baseurl }}"></script>
<script type="text/javascript" src="{{ '/assets/js/libs/slidebars.min.js' | prepend: site.baseurl }}"></script>
<script type="text/javascript" src="{{ '/assets/js/functions.js' | prepend: site.baseurl }}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/3.1.5/js/swiper.jquery.min.js"></script>
<script src="//blueimp.github.io/Gallery/js/jquery.blueimp-gallery.min.js"></script>

<script type="text/javascript">
</script>

<script>

    $(document).ready(function () {
        var slidebars = new $.slidebars();
        var showingText = false;

        var menu = $('.sb-menu');
        var topbar = $('.topbar');
        var menuHeight = menu.height();
        var windowHeight = $(window).height();
        var Gallery = blueimp.Gallery;

        var fillerBlock = $('.filler-block');

        var menuLinks = $('.sb-menu a');
        var body = $('body');
        if (body.scrollTop() > 0) {
            showingText = true;
            fillerBlock.height(200);
        } else {
            fillerBlock.height(windowHeight);
            if (menuLinks.length) {
                disableScroll();
            }
        }

        $('.close-post').click(function (event) {
            scrollToTop();
        });

        $('body').click(function (event) {
            slidebars.slidebars.close();
            if (showingText && (event.target.tagName === 'BODY' || event.target.className.indexOf('filler-block') > -1)) {
                scrollToTop();
            }
        });


        function enableScroll() {
            $('html').css('overflow-y', 'auto');
            showingText = true;
        }

        function disableScroll() {
            $('html').css('overflow-y', 'hidden');
            showingText = false;
        }

        function scrollToTop() {
            disableScroll();
            fillerBlock.animate({height: (windowHeight + body.scrollTop()) + 'px'}, {
                complete: function () {
                    fillerBlock.height(windowHeight);
                    body.scrollTop(0);
                }
            });
        }

        menuLinks.click(function (event) {
            var target = event.currentTarget.getAttribute('href');
            slidebars.slidebars.close();
            enableScroll();
            if (target === '#') {
                event.preventDefault();
                scrollToTop();
                return false;
            } else if (target === '#referanser') {
                //slidebars.slidebars.close();
                $('#links a').first().trigger('click').trigger('click');
                return false;
            } else if (target === '#dokumentasjon') {
                //slidebars.slidebars.close();
                $('#dokumentasjon a').first().trigger('click').trigger('click');
                return false;
            }
            return scrollToTarget(target);
        });

        function scrollToTarget(target) {
            var targetElm = $(target);
            if (targetElm.length) {
                event.preventDefault();
                body.animate({scrollTop: targetElm.offset().top - menuHeight}, {
                    complete: function () {
                        fillerBlock.height(200);
                        body.scrollTop(targetElm.offset().top - menuHeight);
                    }
                });
                return false;
            }
            return true;
        }
    });
</script>
